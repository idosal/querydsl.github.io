<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>3.2. &#44208;&#44284; &#52376;&#47532;</title><link rel="stylesheet" href="css/stylesheet.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.74.0"><link rel="home" href="index.html" title="Querydsl - &#47112;&#54140;&#47088;&#49828; &#47928;&#49436;"><link rel="up" href="ch03.html" title="3&#51109;. &#51068;&#48152; &#49324;&#50857;&#48277;"><link rel="prev" href="ch03.html" title="3&#51109;. &#51068;&#48152; &#49324;&#50857;&#48277;"><link rel="next" href="ch03s03.html" title="3.3. &#53076;&#46300; &#49373;&#49457;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3.2. &#44208;&#44284; &#52376;&#47532;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch03.html">&#51060;&#51204;</a>&nbsp;</td><th width="60%" align="center">3&#51109;. &#51068;&#48152; &#49324;&#50857;&#48277;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch03s03.html">&#45796;&#51020;</a></td></tr></table><hr></div><div class="sect1" lang="ko-KR"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="result_handling"></a>3.2. &#44208;&#44284; &#52376;&#47532;</h2></div></div></div><p>Querydsl&#51008; &#44208;&#44284; &#52376;&#47532;&#47484; &#52964;&#49828;&#53552;&#47560;&#51060;&#51669; &#54616;&#44592; &#50948;&#54644; &#54665; &#44592;&#48152; &#48320;&#54872;&#51012; &#50948;&#54620; FactoryExpressions&#44284;
   &#51665;&#54633;&#51012; &#50948;&#54620; ResultTransformer&#47484; &#51228;&#44277;&#54616;&#44256; &#51080;&#45796;.</p><p><code class="code">com.mysema.query.types.FactoryExpression</code> &#51064;&#53552;&#54168;&#51060;&#49828;&#45716; &#48712; &#49373;&#49457;, &#49373;&#49457;&#51088; &#54840;&#52636; 
  &#44536;&#47532;&#44256; &#45908; &#48373;&#51105;&#54620; &#44061;&#52404;&#47484; &#49373;&#49457;&#54616;&#44592; &#50948;&#54644; &#49324;&#50857;&#46108;&#45796;. <code class="code">com.mysema.query.types.Projections</code> &#53364;&#47000;&#49828;&#47484;
  &#51060;&#50857;&#54644;&#49436; FactoryExpression &#44396;&#54788;&#52404; &#44592;&#45733;&#50640; &#51217;&#44540;&#54624; &#49688; &#51080;&#45796;.</p><p><code class="code">com.mysema.query.ResultTransformer</code> &#51064;&#53552;&#54168;&#51060;&#49828;&#51032; &#51452;&#50836; &#44396;&#54788;&#52404;&#45716; <code class="code">GroupBy</code> &#53364;&#47000;&#49828;&#51060;&#45796;.</p><div class="sect2" lang="ko-KR"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1984"></a>3.2.1. &#45796;&#51473; &#52972;&#47100; &#47532;&#53556;</h3></div></div></div><p>Querydsl 3.0 &#48512;&#53552; &#45796;&#51473; &#52972;&#47100; &#44208;&#44284;&#47484; &#50948;&#54620; &#44592;&#48376; &#53440;&#51077;&#51008; <code class="code">com.mysema.query.Tuple</code> &#51060;&#45796;.
    Tuple&#51008; &#53440;&#51077;&#50640; &#50504;&#51204;&#54620; Map&#51012; &#51228;&#44277;&#54616;&#44256;, &#51060;&#47484; &#53685;&#54644; Tuple &#54665; &#44061;&#52404;&#47196;&#48512;&#53552; &#52972;&#47100; &#45936;&#51060;&#53552;&#50640; &#51217;&#44540;&#54624; &#49688; &#51080;&#45796;.</p><pre class="programlisting">
List&lt;Tuple&gt; result = query.from(employee).list(employee.firstName, employee.lastName);
<span class="hl-keyword">for</span> (Tuple row : result) {
     System.out.println(<span class="hl-string">"firstName "</span> + row.get(employee.firstName));
     System.out.println(<span class="hl-string">"lastName "</span> + row.get(employee.lastName)); 
}}     
</pre><p>&#50948; &#50696;&#51228;&#47484; QTuple &#53364;&#47000;&#49828;&#47484; &#51060;&#50857;&#54616;&#47732; &#45796;&#51020;&#44284; &#44057;&#51060; &#51089;&#49457;&#54624; &#49688; &#51080;&#45796;.</p><pre class="programlisting">
List&lt;Tuple&gt; result = query.from(employee).list(<span class="hl-keyword">new</span> QTuple(employee.firstName, employee.lastName));
<span class="hl-keyword">for</span> (Tuple row : result) {
     System.out.println(<span class="hl-string">"firstName "</span> + row.get(employee.firstName));
     System.out.println(<span class="hl-string">"lastName "</span> + row.get(employee.lastName)); 
}}     
</pre></div><div class="sect2" lang="ko-KR"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1998"></a>3.2.2. &#48712; &#49373;&#49457;(population)</h3></div></div></div><p>&#53244;&#47532; &#44208;&#44284;&#47196;&#48512;&#53552; &#48712;&#51012; &#49373;&#49457;&#54616;&#44256; &#49910;&#45796;&#47732;, Bean &#54532;&#47196;&#51229;&#49496;&#51012; &#49324;&#50857;&#54616;&#47732; &#46108;&#45796;.</p><pre class="programlisting">
List&lt;UserDTO&gt; dtos = query.list(
    Projections.bean(UserDTO.<span class="hl-keyword">class</span>, user.firstName, user.lastName));
</pre><p>setter &#47700;&#49436;&#46300; &#45824;&#49888; &#54596;&#46300;&#50640; &#51649;&#51217; &#51217;&#44540;&#54644;&#50556; &#54620;&#45796;&#47732; &#45796;&#51020; &#53076;&#46300;&#47484; &#49324;&#50857;&#54616;&#47732; &#46108;&#45796;.</p><pre class="programlisting">
List&lt;UserDTO&gt; dtos = query.list(
    Projections.fields(UserDTO.<span class="hl-keyword">class</span>, user.firstName, user.lastName));
</pre></div><div class="sect2" lang="ko-KR"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2009"></a>3.2.3. &#49373;&#49457;&#51088; &#49324;&#50857;</h3></div></div></div><p>&#49373;&#49457;&#51088; &#44592;&#48152;&#51032; &#54665; &#48320;&#54872;&#51012; &#54616;&#45716; &#48169;&#48277;&#51008; &#45796;&#51020;&#44284; &#44057;&#45796;.</p><pre class="programlisting">
List&lt;UserDTO&gt; dtos = query.list(
    Projections.bean(UserDTO.<span class="hl-keyword">class</span>, user.firstName, user.lastName));
</pre><p>&#51648;&#45348;&#47533; &#49373;&#49457;&#51088; &#54364;&#54788;&#49885;&#51012; &#49324;&#50857;&#54616;&#45716; &#45824;&#49888;, <code class="code">QueryProjection</code> &#50612;&#45432;&#53580;&#51060;&#49496;&#51012; &#51201;&#50857;&#54620; &#49373;&#49457;&#51088;&#47484; &#49324;&#50857;&#54624; &#49688;&#46020; &#51080;&#45796;.
    </p><pre class="programlisting">
<span class="hl-keyword">class</span> CustomerDTO {

  <span class="hl-annotation">@QueryProjection</span>
  <span class="hl-keyword">public</span> CustomerDTO(<span class="hl-keyword">long</span> id, String name){
     ...
  }

}
</pre><p>&#44536;&#47532;&#44256;, &#51060; &#53364;&#47000;&#49828;&#47484; &#45796;&#51020;&#44284; &#44057;&#51060; &#53244;&#47532;&#50640;&#49436; &#49324;&#50857; &#44032;&#45733;&#54616;&#45796;.</p><pre class="programlisting">
QCustomer customer = QCustomer.customer;
JPQLQuery query = <span class="hl-keyword">new</span> HibernateQuery(session);
List&lt;CustomerDTO&gt; dtos = query.from(customer).list(<span class="hl-keyword">new</span> QCustomerDTO(customer.id, customer.name));     
</pre><p>&#51060; &#50696;&#51228;&#44032; Hibernate&#50857; &#53076;&#46300;&#51060;&#44596; &#54616;&#51648;&#47564;, &#45796;&#47480; &#47784;&#46304; &#47784;&#46280;&#50640;&#49436;&#46020; &#51060; &#44592;&#45733;&#51012; &#49324;&#50857;&#54624; &#49688; &#51080;&#45796;.
    </p><p>&#47564;&#50557; QueryProjection &#50612;&#45432;&#53580;&#51060;&#49496;&#51060; &#51201;&#50857;&#46108; &#53440;&#51077;&#51060; &#50644;&#54000;&#54000;(@Entity) &#53440;&#51077;&#51060; &#50500;&#45768;&#46972;&#47732;,
      &#50696;&#51228;&#52376;&#47100; &#49373;&#49457;&#51088; &#54532;&#47196;&#51229;&#49496;&#51012; &#49324;&#50857;&#54624; &#49688; &#51080;&#45796;. &#54616;&#51648;&#47564;, &#50612;&#45432;&#53580;&#51060;&#49496;&#51060; &#51201;&#50857;&#46108; &#53440;&#51077;&#51060;
      &#50644;&#54000;&#54000;(@Entity) &#53440;&#51077;&#51060;&#46972;&#47732; &#53244;&#47532; &#53440;&#51077;&#51032; &#51221;&#51201; create &#47700;&#49436;&#46300;&#47484; &#49892;&#54665;&#54644;&#49436; &#49373;&#49457;&#51088; &#54532;&#47196;&#51229;&#49496;&#51012;
      &#47564;&#46308; &#54596;&#50836;&#44032; &#51080;&#45796;.
    </p><pre class="programlisting">
<span class="hl-annotation">@Entity</span>
<span class="hl-keyword">class</span> Customer {

  <span class="hl-annotation">@QueryProjection</span>
  <span class="hl-keyword">public</span> Customer(<span class="hl-keyword">long</span> id, String name){
     ...
  }

}
</pre><pre class="programlisting">
QCustomer customer = QCustomer.customer;
JPQLQuery query = <span class="hl-keyword">new</span> HibernateQuery(session);
List&lt;Customer&gt; dtos = query.from(customer).list(QCustomer.create(customer.id, customer.name));   
</pre><p>&#53076;&#46300; &#49373;&#49457;&#51012; &#54624; &#49688; &#50630;&#45796;&#47732;, &#45796;&#51020;&#44284; &#44057;&#51060; &#49373;&#49457;&#51088; &#54532;&#47196;&#51229;&#49496;&#51012; &#49373;&#49457;&#54624; &#49688; &#51080;&#45796;.
    </p><pre class="programlisting">
List&lt;Customer&gt; dtos = query.from(customer)
    .list(ConstructorExpression.create(Customer.<span class="hl-keyword">class</span>, customer.id, customer.name));   
</pre></div><div class="sect2" lang="ko-KR"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2039"></a>3.2.4. &#44208;&#44284; &#51665;&#54633;(aggregation)</h3></div></div></div><p>
      <code class="code">com.mysema.query.group.GroupBy</code> &#53364;&#47000;&#49828;&#45716; &#47700;&#47784;&#47532;&#50640;&#49436; &#53244;&#47532; &#44208;&#44284;&#50640; &#45824;&#54620; &#51665;&#54633; &#50672;&#49328;&#51012; &#49688;&#54665;&#54616;&#45716;
      &#51665;&#54633; &#54632;&#49688;&#47484; &#51228;&#44277;&#54620;&#45796;. &#45796;&#51020;&#51008; &#49324;&#50857; &#50696;&#51060;&#45796;.
    </p><p>
      &#48512;&#47784; &#51088;&#49885; &#44288;&#44228;&#50640; &#45824;&#54620; &#51665;&#54633; &#50672;&#49328;
    </p><pre class="programlisting">
<span class="hl-keyword">import</span> <span class="hl-keyword">static</span> com.mysema.query.group.GroupBy.*;
   
Map&lt;Integer, List&lt;Comment&gt;&gt; results = query.from(post, comment)
    .where(comment.post.id.eq(post.id))
    .transform(groupBy(post.id).as(list(comment)));
</pre><p>&#51060; &#53076;&#46300;&#45716; post id&#50752; &#44288;&#47144;&#46108; &#52964;&#47704;&#53944;&#47484; &#47588;&#54609;&#54620;&#45796;.</p><p>&#45796;&#51473; &#44208;&#44284; &#52972;&#47100;</p><pre class="programlisting">    
Map&lt;Integer, Group&gt; results = query.from(post, comment)
    .where(comment.post.id.eq(post.id))
    .transform(groupBy(post.id).as(post.name, set(comment.id)));
</pre><p>&#51060; &#53076;&#46300;&#45716; post id&#50752; Group&#51012; &#47588;&#54609;&#54620;&#45796;. Group&#51008; post name&#44284; comment id&#47484; &#44054;&#45716;&#45796;.
    </p><p>Group&#51008; GroupBy&#50640; &#45824;&#54644; Tuple &#51064;&#53552;&#54168;&#51060;&#49828;&#50752; &#44057;&#51008; &#50669;&#54624;&#51012; &#54620;&#45796;.</p><p>
      &#45908; &#47566;&#51008; &#50696;&#51228;&#45716; 
      <a class="ulink" href="https://github.com/mysema/querydsl/blob/master/querydsl-collections/src/test/java/com/mysema/query/collections/GroupByTest.java" target="_top">&#50668;&#44592;</a>&#47484; &#52280;&#44256;&#54620;&#45796;.
      .
    </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch03.html">&#51060;&#51204;</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch03.html">&#50948;&#47196;</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch03s03.html">&#45796;&#51020;</a></td></tr><tr><td width="40%" align="left" valign="top">3&#51109;. &#51068;&#48152; &#49324;&#50857;&#48277;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">&#52376;&#51020;&#51004;&#47196;</a></td><td width="40%" align="right" valign="top">&nbsp;3.3. &#53076;&#46300; &#49373;&#49457;</td></tr></table></div></body></html>